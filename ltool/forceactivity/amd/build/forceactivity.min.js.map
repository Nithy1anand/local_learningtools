{"version":3,"sources":["../src/forceactivity.js"],"names":["define","$","ModalFactory","Str","Fragment","ModalEvents","Ajax","notification","learningToolforceactivityAction","params","showModalforceactivitytool","forceactivityinfo","document","querySelector","addEventListener","create","title","get_string","type","types","SAVE_CANCEL","body","getForceActivityModal","large","then","modal","show","getRoot","on","hidden","destroy","save","e","preventDefault","submitFormData","submit","catch","exception","forceactivityhovercolor","getAttribute","style","background","modalform","querySelectorAll","formData","URLSearchParams","FormData","toString","JSON","stringify","call","methodname","args","formdata","done","response","hide","successinfo","when","localizedEditString","addNotification","message","loadFragment","contextid","init"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * forceactivity ltool define js.\n * @package   ltool_forceactivity\n * @category  Classes - autoloading\n * @copyright 2021, bdecent gmbh bdecent.de\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n define(['jquery', 'core/modal_factory', 'core/str', 'core/fragment', 'core/modal_events', 'core/ajax', 'core/notification'],\n function($, ModalFactory, Str, Fragment, ModalEvents, Ajax, notification) {\n\n    /**\n     * Controls bookmarks tool action.\n     * @param {object} params\n     */\n    function learningToolforceactivityAction(params) {\n        showModalforceactivitytool(params);\n    }\n\n    /**\n     * Display the modal to forceactivity user emails.\n     * @param {object} params\n     */\n    function showModalforceactivitytool(params) {\n        var forceactivityinfo = document.querySelector(\".ltoolforceactivity-info #ltoolforceactivity-action\");\n        if (forceactivityinfo) {\n            forceactivityinfo.addEventListener(\"click\", function() {\n                // Strforceactivityusers.\n                ModalFactory.create({\n                    title: Str.get_string('forceactivity', 'local_learningtools'),\n                    type: ModalFactory.types.SAVE_CANCEL,\n                    body: getForceActivityModal(params),\n                    large: true\n                }).then(function(modal) {\n                    modal.show();\n                    modal.getRoot().on(ModalEvents.hidden, function() {\n                        modal.destroy();\n                    });\n                    modal.getRoot().on(ModalEvents.save, function(e) {\n                        e.preventDefault();\n                        submitFormData(modal, params);\n                        modal.getRoot().submit();\n                    });\n                    return modal;\n                }).catch(notification.exception);\n            });\n\n            // Hover color.\n            var forceactivityhovercolor = forceactivityinfo.getAttribute(\"data-hovercolor\");\n            if (forceactivityhovercolor) {\n                forceactivityinfo.addEventListener(\"mouseover\", function() {\n                    document.querySelector('#ltoolforceactivity-action p').style.background = forceactivityhovercolor;\n                });\n            }\n        }\n    }\n\n    /**\n     * Submit the modal data form.\n     * @param {object} modal object\n     * @param {array} params  list of parameters\n     * @return {void} ajax respoltoolsnse.\n     */\n    function submitFormData(modal, params) {\n        var modalform = document.querySelectorAll('#forceactivity-modalinfo form')[0];\n        var formData = new URLSearchParams(new FormData(modalform)).toString();\n        params = JSON.stringify(params);\n        Ajax.call([{\n            methodname: 'ltool_forceactivity_forceactivityaction',\n            args: {params: params, formdata: formData},\n            done: function(response) {\n                modal.hide();\n                if (response) {\n                    var successinfo = Str.get_string('successforceactivityusers', 'local_learningtools');\n                    $.when(successinfo).done(function(localizedEditString) {\n                        notification.addNotification({\n                            message: localizedEditString,\n                            type: \"success\"\n                        });\n                    });\n                }\n            }\n        }]);\n    }\n    /**\n     * Get forceactivity Modal info.\n     * @param {object} params\n     * @return {string} textarea html\n     */\n    function getForceActivityModal(params) {\n        return Fragment.loadFragment('ltool_forceactivity', 'get_forceactivitymodal_form', params.contextid, params);\n    }\n\n    return {\n        init: function(params) {\n            learningToolforceactivityAction(params);\n        }\n    };\n });"],"file":"forceactivity.min.js"}